<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Explanation | Causal Models: Guide to CausalQueries</title>
  <meta name="description" content="Model based strategies for integrating qualitative and quantitative inferences." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Explanation | Causal Models: Guide to CausalQueries" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Model based strategies for integrating qualitative and quantitative inferences." />
  <meta name="github-repo" content="rstudio/causalmodels" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Explanation | Causal Models: Guide to CausalQueries" />
  
  <meta name="twitter:description" content="Model based strategies for integrating qualitative and quantitative inferences." />
  

<meta name="author" content="Macartan Humphreys and Alan Jacobs" />


<meta name="date" content="2020-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="applications.html"/>
<link rel="next" href="process-tracing.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="headers\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Model based causal inference: A guide to gbiqq</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Causal Models</b></span></li>
<li class="chapter" data-level="1" data-path="cm.html"><a href="cm.html"><i class="fa fa-check"></i><b>1</b> What and why</a><ul>
<li class="chapter" data-level="1.1" data-path="cm.html"><a href="cm.html#two-approaches-to-inference"><i class="fa fa-check"></i><b>1.1</b> Two approaches to inference</a></li>
<li class="chapter" data-level="1.2" data-path="cm.html"><a href="cm.html#recovering-the-ate-with-difference-in-means"><i class="fa fa-check"></i><b>1.2</b> Recovering the ATE with Difference in Means</a></li>
<li class="chapter" data-level="1.3" data-path="cm.html"><a href="cm.html#recovering-the-ate-with-a-causal-model"><i class="fa fa-check"></i><b>1.3</b> Recovering the ATE with a Causal Model</a></li>
<li class="chapter" data-level="1.4" data-path="cm.html"><a href="cm.html#going-further"><i class="fa fa-check"></i><b>1.4</b> Going further</a></li>
</ul></li>
<li class="part"><span><b>II The Package</b></span></li>
<li class="chapter" data-level="2" data-path="package.html"><a href="package.html"><i class="fa fa-check"></i><b>2</b> Installation</a></li>
<li class="chapter" data-level="3" data-path="defining-models.html"><a href="defining-models.html"><i class="fa fa-check"></i><b>3</b> Defining models</a><ul>
<li class="chapter" data-level="3.1" data-path="defining-models.html"><a href="defining-models.html#getting-going"><i class="fa fa-check"></i><b>3.1</b> Getting going</a></li>
<li class="chapter" data-level="3.2" data-path="defining-models.html"><a href="defining-models.html#structure"><i class="fa fa-check"></i><b>3.2</b> Causal structure</a><ul>
<li class="chapter" data-level="3.2.1" data-path="defining-models.html"><a href="defining-models.html#nodal-types"><i class="fa fa-check"></i><b>3.2.1</b> Nodal types</a></li>
<li class="chapter" data-level="3.2.2" data-path="defining-models.html"><a href="defining-models.html#causal-types"><i class="fa fa-check"></i><b>3.2.2</b> Causal types</a></li>
<li class="chapter" data-level="3.2.3" data-path="defining-models.html"><a href="defining-models.html#parameters-dataframe"><i class="fa fa-check"></i><b>3.2.3</b> Parameters dataframe</a></li>
<li class="chapter" data-level="3.2.4" data-path="defining-models.html"><a href="defining-models.html#parameter-matrix"><i class="fa fa-check"></i><b>3.2.4</b> Parameter matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="defining-models.html"><a href="defining-models.html#restrictions"><i class="fa fa-check"></i><b>3.3</b> Setting restrictions</a></li>
<li class="chapter" data-level="3.4" data-path="defining-models.html"><a href="defining-models.html#confounding"><i class="fa fa-check"></i><b>3.4</b> Allowing confounding</a></li>
<li class="chapter" data-level="3.5" data-path="defining-models.html"><a href="defining-models.html#priors"><i class="fa fa-check"></i><b>3.5</b> Setting Priors</a><ul>
<li class="chapter" data-level="3.5.1" data-path="defining-models.html"><a href="defining-models.html#custom-priors"><i class="fa fa-check"></i><b>3.5.1</b> Custom priors</a></li>
<li class="chapter" data-level="3.5.2" data-path="defining-models.html"><a href="defining-models.html#prior-warnings"><i class="fa fa-check"></i><b>3.5.2</b> Prior warnings</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="defining-models.html"><a href="defining-models.html#parameters"><i class="fa fa-check"></i><b>3.6</b> Setting Parameters</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="updating-models-with-stan.html"><a href="updating-models-with-stan.html"><i class="fa fa-check"></i><b>4</b> Updating models with <code>stan</code></a><ul>
<li class="chapter" data-level="4.1" data-path="updating-models-with-stan.html"><a href="updating-models-with-stan.html#data-for-stan"><i class="fa fa-check"></i><b>4.1</b> Data for <code>stan</code></a></li>
<li class="chapter" data-level="4.2" data-path="updating-models-with-stan.html"><a href="updating-models-with-stan.html#stan-code"><i class="fa fa-check"></i><b>4.2</b> <code>stan</code> code</a></li>
<li class="chapter" data-level="4.3" data-path="updating-models-with-stan.html"><a href="updating-models-with-stan.html#implementation"><i class="fa fa-check"></i><b>4.3</b> Implementation</a></li>
<li class="chapter" data-level="4.4" data-path="updating-models-with-stan.html"><a href="updating-models-with-stan.html#extensions"><i class="fa fa-check"></i><b>4.4</b> Extensions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="updating-models-with-stan.html"><a href="updating-models-with-stan.html#arbitrary-parameters"><i class="fa fa-check"></i><b>4.4.1</b> Arbitrary parameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="updating-models-with-stan.html"><a href="updating-models-with-stan.html#non-binary-data"><i class="fa fa-check"></i><b>4.4.2</b> Non binary data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="querying-models.html"><a href="querying-models.html"><i class="fa fa-check"></i><b>5</b> Querying models</a><ul>
<li class="chapter" data-level="5.1" data-path="querying-models.html"><a href="querying-models.html#case-level-queries"><i class="fa fa-check"></i><b>5.1</b> Case level queries</a></li>
<li class="chapter" data-level="5.2" data-path="querying-models.html"><a href="querying-models.html#posterior-queries"><i class="fa fa-check"></i><b>5.2</b> Posterior queries</a></li>
<li class="chapter" data-level="5.3" data-path="querying-models.html"><a href="querying-models.html#query-distribution"><i class="fa fa-check"></i><b>5.3</b> Query distribution</a></li>
<li class="chapter" data-level="5.4" data-path="querying-models.html"><a href="querying-models.html#token-and-general-causation"><i class="fa fa-check"></i><b>5.4</b> Token and general causation</a></li>
<li class="chapter" data-level="5.5" data-path="querying-models.html"><a href="querying-models.html#complex-queries"><i class="fa fa-check"></i><b>5.5</b> Complex queries</a></li>
</ul></li>
<li class="part"><span><b>III Applications</b></span></li>
<li class="chapter" data-level="6" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>6</b> Basic Models</a><ul>
<li class="chapter" data-level="6.1" data-path="applications.html"><a href="applications.html#the-ladder-of-causation-in-an-x-rightarrow-y-model"><i class="fa fa-check"></i><b>6.1</b> The ladder of causation in an <span class="math inline">\(X \rightarrow Y\)</span> model</a></li>
<li class="chapter" data-level="6.2" data-path="applications.html"><a href="applications.html#x-causes-y-with-unmodelled-confounding"><i class="fa fa-check"></i><b>6.2</b> <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span>, with unmodelled confounding</a></li>
<li class="chapter" data-level="6.3" data-path="applications.html"><a href="applications.html#x-causes-y-with-confounding-modeled"><i class="fa fa-check"></i><b>6.3</b> <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span>, with confounding modeled</a></li>
<li class="chapter" data-level="6.4" data-path="applications.html"><a href="applications.html#simple-mediation-model"><i class="fa fa-check"></i><b>6.4</b> Simple mediation model</a></li>
<li class="chapter" data-level="6.5" data-path="applications.html"><a href="applications.html#simple-moderator-model"><i class="fa fa-check"></i><b>6.5</b> Simple moderator model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="explanation.html"><a href="explanation.html"><i class="fa fa-check"></i><b>7</b> Explanation</a><ul>
<li class="chapter" data-level="7.1" data-path="explanation.html"><a href="explanation.html#tightening-bounds-on-causes-of-effects-using-an-unobserved-covariate"><i class="fa fa-check"></i><b>7.1</b> Tightening bounds on causes of effects using an unobserved covariate</a></li>
<li class="chapter" data-level="7.2" data-path="explanation.html"><a href="explanation.html#Billy"><i class="fa fa-check"></i><b>7.2</b> Actual Causation: Billy and Suzy’s moderator and mediation model</a></li>
<li class="chapter" data-level="7.3" data-path="explanation.html"><a href="explanation.html#diagnosis-inferring-a-cause-from-symptoms"><i class="fa fa-check"></i><b>7.3</b> Diagnosis: Inferring a cause from symptoms</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="process-tracing.html"><a href="process-tracing.html"><i class="fa fa-check"></i><b>8</b> Process tracing</a><ul>
<li class="chapter" data-level="8.1" data-path="process-tracing.html"><a href="process-tracing.html#what-to-infer-from-what"><i class="fa fa-check"></i><b>8.1</b> What to infer from what</a></li>
<li class="chapter" data-level="8.2" data-path="process-tracing.html"><a href="process-tracing.html#probative-value-and-d-separation"><i class="fa fa-check"></i><b>8.2</b> Probative value and <span class="math inline">\(d\)</span>-separation</a></li>
<li class="chapter" data-level="8.3" data-path="process-tracing.html"><a href="process-tracing.html#foundations-for-van-everas-tests"><i class="fa fa-check"></i><b>8.3</b> Foundations for Van Evera’s tests</a></li>
<li class="chapter" data-level="8.4" data-path="process-tracing.html"><a href="process-tracing.html#clue-selection-clues-at-the-center-of-chains-can-be-more-informative"><i class="fa fa-check"></i><b>8.4</b> Clue selection: clues at the center of chains can be more informative</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="identification.html"><a href="identification.html"><i class="fa fa-check"></i><b>9</b> Identification</a><ul>
<li class="chapter" data-level="9.1" data-path="identification.html"><a href="identification.html#illustration-of-the-backdoor-criterion"><i class="fa fa-check"></i><b>9.1</b> Illustration of the backdoor criterion</a></li>
<li class="chapter" data-level="9.2" data-path="identification.html"><a href="identification.html#identification-instruments"><i class="fa fa-check"></i><b>9.2</b> Identification: Instruments</a></li>
<li class="chapter" data-level="9.3" data-path="identification.html"><a href="identification.html#identification-through-the-frontdoor"><i class="fa fa-check"></i><b>9.3</b> Identification through the frontdoor</a></li>
<li class="chapter" data-level="9.4" data-path="identification.html"><a href="identification.html#simple-sample-selection-bias"><i class="fa fa-check"></i><b>9.4</b> Simple sample selection bias</a></li>
<li class="chapter" data-level="9.5" data-path="identification.html"><a href="identification.html#addressing-both-sample-selection-bias-and-confounding"><i class="fa fa-check"></i><b>9.5</b> Addressing both sample selection bias and confounding</a></li>
<li class="chapter" data-level="9.6" data-path="identification.html"><a href="identification.html#learning-from-a-collider"><i class="fa fa-check"></i><b>9.6</b> Learning from a collider!</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mixing-methods.html"><a href="mixing-methods.html"><i class="fa fa-check"></i><b>10</b> Mixing methods</a><ul>
<li class="chapter" data-level="10.1" data-path="mixing-methods.html"><a href="mixing-methods.html#using-within-case-data-to-help-with-identification"><i class="fa fa-check"></i><b>10.1</b> Using within case data to help with identification</a></li>
<li class="chapter" data-level="10.2" data-path="mixing-methods.html"><a href="mixing-methods.html#distinguishing-paths"><i class="fa fa-check"></i><b>10.2</b> Distinguishing paths</a></li>
<li class="chapter" data-level="10.3" data-path="mixing-methods.html"><a href="mixing-methods.html#nothing-from-nothing"><i class="fa fa-check"></i><b>10.3</b> Nothing from nothing</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="external-validity-and-inference-aggregation.html"><a href="external-validity-and-inference-aggregation.html"><i class="fa fa-check"></i><b>11</b> External validity and inference aggregation</a><ul>
<li class="chapter" data-level="11.1" data-path="external-validity-and-inference-aggregation.html"><a href="external-validity-and-inference-aggregation.html#transportation-of-findings-across-contexts"><i class="fa fa-check"></i><b>11.1</b> Transportation of findings across contexts</a></li>
<li class="chapter" data-level="11.2" data-path="external-validity-and-inference-aggregation.html"><a href="external-validity-and-inference-aggregation.html#combining-observational-and-experimental-data"><i class="fa fa-check"></i><b>11.2</b> Combining observational and experimental data</a></li>
<li class="chapter" data-level="11.3" data-path="external-validity-and-inference-aggregation.html"><a href="external-validity-and-inference-aggregation.html#a-jigsaw-puzzle-learning-across-populations"><i class="fa fa-check"></i><b>11.3</b> A jigsaw puzzle: Learning across populations</a></li>
</ul></li>
<li class="part"><span><b>IV Notation</b></span></li>
<li class="chapter" data-level="12" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i><b>12</b> Notation and syntax</a><ul>
<li class="chapter" data-level="12.1" data-path="notation.html"><a href="notation.html#notation-1"><i class="fa fa-check"></i><b>12.1</b> Notation</a><ul>
<li class="chapter" data-level="12.1.1" data-path="notation.html"><a href="notation.html#parents"><i class="fa fa-check"></i><b>12.1.1</b> Parents, children, and all that</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="notation.html"><a href="notation.html#syntax"><i class="fa fa-check"></i><b>12.2</b> Causal syntax</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/macartan/gbiqq/" target="blank">Uses gbiqq</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Causal Models: Guide to <code>CausalQueries</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="explanation" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Explanation</h1>
<div id="tightening-bounds-on-causes-of-effects-using-an-unobserved-covariate" class="section level2">
<h2><span class="header-section-number">7.1</span> Tightening bounds on causes of effects using an unobserved covariate</h2>
<p>“Explanation” can sometimes be thought of assessing whether an outcome was due to a cause: “<span class="math inline">\(Y\)</span> because <span class="math inline">\(X\)</span>.” We saw examples showing the difficulty of identifying the “probability of causation” (whether <span class="math inline">\(X\)</span> caused <span class="math inline">\(Y\)</span> in a case) above (See for example Figure <a href="applications.html#fig:PChist">6.1</a>).</p>
<p>Knowledge of moderators and mediators can help however. In a particularly striking result, <span class="citation">Dawid (<a href="#ref-dawid2011role" role="doc-biblioref">2011</a>)</span> shows that knowledge derived from moderators can help <em>even when the moderator is not observed for the case in question</em>.</p>
<p>We illustrate with a simple example in which data is drawn from a process in which <span class="math inline">\(X\)</span> has a positive effect on <span class="math inline">\(Y\)</span> when <span class="math inline">\(C=1\)</span> and a negative effect otherwise. We will assume <span class="math inline">\(X\)</span> is as-if randomized, though <span class="math inline">\(C\)</span> is not:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X -&gt; Y &lt;- C; Y &lt;-&gt; C&quot;</span>)</a>
<a class="sourceLine" id="cb81-2" title="2"></a>
<a class="sourceLine" id="cb81-3" title="3">data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb81-4" title="4"><span class="st">  </span>model <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-5" title="5"><span class="st">  </span><span class="kw">set_restrictions</span>(<span class="st">&quot;(Y[X=1, C=1] &gt; Y[X=0, C=1]) &amp; </span></a>
<a class="sourceLine" id="cb81-6" title="6"><span class="st">                    (Y[X=1, C=0] &lt; Y[X=0, C=0])&quot;</span>, <span class="dt">keep =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-7" title="7"><span class="st">  </span><span class="kw">make_data</span>(<span class="dt">n=</span> <span class="dv">200</span>)</a></code></pre></div>
<p>These restrictions, coupled with flat priors, produce the following priors (i) on the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> and (ii) that <span class="math inline">\(X\)</span> caused <span class="math inline">\(Y\)</span> in a case with <span class="math inline">\(X=Y=1\)</span>:</p>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Given</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">All</td>
<td align="left">priors</td>
<td align="right">0.001</td>
<td align="right">0.141</td>
</tr>
<tr class="even">
<td align="left">PC</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">priors</td>
<td align="right">0.499</td>
<td align="right">0.136</td>
</tr>
</tbody>
</table>
<p>We now compare inferences on the PC (for a case where we have no data on <span class="math inline">\(C\)</span>) using one model that has been updated using data on <span class="math inline">\(C\)</span> and one that has not:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">update_model</span>(model, <span class="kw">select</span>(data, X, Y)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb82-3" title="3"><span class="st">  </span><span class="kw">query_model</span>(<span class="dt">query =</span> <span class="st">&quot;Y[X=1]&gt;Y[X=0]&quot;</span>, <span class="dt">given =</span> <span class="st">&quot;X==1 &amp; Y==1&quot;</span>,</a>
<a class="sourceLine" id="cb82-4" title="4">              <span class="dt">using =</span> <span class="st">&quot;posteriors&quot;</span>) </a>
<a class="sourceLine" id="cb82-5" title="5"></a>
<a class="sourceLine" id="cb82-6" title="6"><span class="kw">update_model</span>(model, data) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-7" title="7"></a>
<a class="sourceLine" id="cb82-8" title="8"><span class="st">    </span><span class="kw">query_model</span>(<span class="dt">query =</span> <span class="st">&quot;Y[X=1]&gt;Y[X=0]&quot;</span>, <span class="dt">given =</span> <span class="st">&quot;X==1 &amp; Y==1&quot;</span>, </a>
<a class="sourceLine" id="cb82-9" title="9">              <span class="dt">using =</span> <span class="st">&quot;posteriors&quot;</span>) </a></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-80">Table 7.1: </span>Probability <span class="math inline">\(X\)</span> caused <span class="math inline">\(Y\)</span> from model updated without data on <span class="math inline">\(C\)</span></caption>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Given</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X caused Y</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">posteriors</td>
<td align="right">0.502</td>
<td align="right">0.103</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-81">Table 7.2: </span>Probability <span class="math inline">\(X\)</span> caused <span class="math inline">\(Y\)</span> from model updated using data on <span class="math inline">\(C\)</span></caption>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Given</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X caused Y</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">posteriors</td>
<td align="right">0.868</td>
<td align="right">0.042</td>
</tr>
</tbody>
</table>
<p>We see tight gains even though <span class="math inline">\(C\)</span> is not observed. The remarkable result arises because although <span class="math inline">\(C\)</span> is not observed in the case at hand, the model that has been updated with knowledge of <span class="math inline">\(C\)</span> lets us figure out that the average effect of 0 is due to strong heterogeneity of effects. Indeed <span class="math inline">\(X=Y=1\)</span> only arises when <span class="math inline">\(C=1\)</span>, in which case <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span>. Thus observing <span class="math inline">\(X=Y=1\)</span> lets us infer that <span class="math inline">\(C=1\)</span> and so in this case <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span>.</p>
</div>
<div id="Billy" class="section level2">
<h2><span class="header-section-number">7.2</span> Actual Causation: Billy and Suzy’s moderator and mediation model</h2>
<p>A classic problem in the philosophy of causation examines a story in which Billy and Suzy throw stones at a bottle <span class="citation">(Hall <a href="#ref-hall2004two" role="doc-biblioref">2004</a>)</span>. Both are deadly shots but Suzy’s stone hits the bottle first. Had it not, Billy’s surely would have. Can we say that Suzy’s throw caused the bottle to break if it would have broken even if she hadn’t thrown?</p>
<p>We model a simple version of the Billy and Suzy stone throwing game as a causal model with moderation and mediation in three nodes.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;Suzy -&gt; Billy -&gt; Smash &lt;- Suzy&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="st">         </span><span class="kw">set_restrictions</span>(<span class="kw">c</span>(</a>
<a class="sourceLine" id="cb83-3" title="3">           </a>
<a class="sourceLine" id="cb83-4" title="4">           <span class="co"># If Suzy throws the bottle breaks</span></a>
<a class="sourceLine" id="cb83-5" title="5">           <span class="st">&quot;(Smash[Suzy=1]==0)&quot;</span>,</a>
<a class="sourceLine" id="cb83-6" title="6"></a>
<a class="sourceLine" id="cb83-7" title="7">           <span class="co"># The bottle won&#39;t break by itself</span></a>
<a class="sourceLine" id="cb83-8" title="8">           <span class="st">&quot;(Smash[Billy=0, Suzy = 0]==1)&quot;</span>,</a>
<a class="sourceLine" id="cb83-9" title="9">           </a>
<a class="sourceLine" id="cb83-10" title="10">           <span class="co"># Suzy&#39;s throw doesn&#39;t *encourage* Billy to throw</span></a>
<a class="sourceLine" id="cb83-11" title="11">           <span class="st">&quot;Billy[Suzy=1]&gt;Billy[Suzy=0]&quot;</span>))</a>
<a class="sourceLine" id="cb83-12" title="12"><span class="kw">plot</span>(model)</a></code></pre></div>
<p><img src="causalmodels_files/figure-html/appbillysuzy1-1.png" width="672" /></p>
<p>Here “Suzy” means Suzy throws, “Billy”: means Billy throws—which he might not do if Suzy throws—and “Smash” means the bottle gets smashed.</p>
<p>The version here is a somewhat less deterministic version of the classic account. Suzy is still an ace shot but now she may or may not throw and Billy may or may not respond positively to Suzy and if he does respond he may or may not be successful. With all these possibilities we have twelve unit causal types instead of 1.</p>
<p>We have two estimands of interest: counterfactual causation and actual causation. Conditional on Suzy throwing and the bottle breaking, would the bottle not have broken had Suzy not thrown her stone? That’s counterfactual causation. The actual causation asks the same question but <em>conditioning</em> on the fact that Billy did or did not throw <em>his</em> stone—which we know could itself be due to Suzy throwing her stone. If so then we might think of an “active path” from Suzy’s throw to the smashing, even though had she not thrown the bottle might have smashed anyhow.</p>
<p>Our results:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">actual_cause &lt;-<span class="st"> </span><span class="kw">query_model</span>(model, <span class="dt">using =</span> <span class="st">&quot;priors&quot;</span>,</a>
<a class="sourceLine" id="cb84-2" title="2">  <span class="dt">queries =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb84-3" title="3">    <span class="dt">Counterfactual =</span> <span class="st">&quot;Smash[Suzy = 1] &gt; Smash[Suzy = 0]&quot;</span>,</a>
<a class="sourceLine" id="cb84-4" title="4">    <span class="dt">Actual =</span> <span class="st">&quot;Smash[Suzy = 1, Billy = Billy[Suzy = 1] ] &gt; </span></a>
<a class="sourceLine" id="cb84-5" title="5"><span class="st">              Smash[Suzy = 0, Billy = Billy[Suzy = 1]]&quot;</span>),</a>
<a class="sourceLine" id="cb84-6" title="6">  <span class="dt">given =</span> <span class="kw">c</span>(<span class="st">&quot;Suzy==1 &amp; Smash==1&quot;</span>, <span class="st">&quot;Suzy==1 &amp; Smash==1 &amp; Billy==0&quot;</span>, <span class="st">&quot;Suzy==1 &amp; Smash==1 &amp; Billy==1&quot;</span>),</a>
<a class="sourceLine" id="cb84-7" title="7">  <span class="dt">expand_grid =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb84-8" title="8">  )</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Given</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Counterfactual</td>
<td align="left">Suzy==1 &amp; Smash==1</td>
<td align="left">priors</td>
<td align="right">0.663</td>
<td align="right">0.237</td>
</tr>
<tr class="even">
<td align="left">Counterfactual</td>
<td align="left">Suzy==1 &amp; Smash==1 &amp; Billy==0</td>
<td align="left">priors</td>
<td align="right">0.748</td>
<td align="right">0.223</td>
</tr>
<tr class="odd">
<td align="left">Counterfactual</td>
<td align="left">Suzy==1 &amp; Smash==1 &amp; Billy==1</td>
<td align="left">priors</td>
<td align="right">0.497</td>
<td align="right">0.287</td>
</tr>
<tr class="even">
<td align="left">Actual</td>
<td align="left">Suzy==1 &amp; Smash==1</td>
<td align="left">priors</td>
<td align="right">0.831</td>
<td align="right">0.168</td>
</tr>
<tr class="odd">
<td align="left">Actual</td>
<td align="left">Suzy==1 &amp; Smash==1 &amp; Billy==0</td>
<td align="left">priors</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">Actual</td>
<td align="left">Suzy==1 &amp; Smash==1 &amp; Billy==1</td>
<td align="left">priors</td>
<td align="right">0.497</td>
<td align="right">0.287</td>
</tr>
</tbody>
</table>
<p>Our inferences, <em>without even observing</em> Billy’s throw distinguish between Suzy being a counterfactual cause and an actual cause. We think it likely that Suzy’s throw was an actual cause of the outcome though we are less sure that it was a counterfactual causes. Observing Billy’s throw strengthens our inferences. If Billy didn’t throw then we are sure Suzy’s throw was the actual cause, though we are still in doubt about whether her throw was a counterfactual cause (since Billy might have thrown if she hadn’t).</p>
<p>Note that if we observed Suzy <em>not</em> throwing then we would learn <em>more</em> about whether she would be a counterfactual cause since we would have learned more about whether Billy reacts to her and also about whether Billy is a good shot.</p>
<table>
<caption><span id="tab:appbillysuzy3">Table 7.3: </span>Inferences when Suzy does <em>not</em> throw</caption>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Given</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Counterfactual</td>
<td align="left">Suzy==0 &amp; Billy==0</td>
<td align="left">priors</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">Counterfactual</td>
<td align="left">Suzy==0 &amp; Billy==1</td>
<td align="left">priors</td>
<td align="right">0.495</td>
<td align="right">0.287</td>
</tr>
<tr class="odd">
<td align="left">Counterfactual</td>
<td align="left">Suzy==0 &amp; Billy==1 &amp; Smash==1</td>
<td align="left">priors</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">Actual</td>
<td align="left">Suzy==0 &amp; Billy==0</td>
<td align="left">priors</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">Actual</td>
<td align="left">Suzy==0 &amp; Billy==1</td>
<td align="left">priors</td>
<td align="right">0.743</td>
<td align="right">0.222</td>
</tr>
<tr class="even">
<td align="left">Actual</td>
<td align="left">Suzy==0 &amp; Billy==1 &amp; Smash==1</td>
<td align="left">priors</td>
<td align="right">0.491</td>
<td align="right">0.290</td>
</tr>
</tbody>
</table>
</div>
<div id="diagnosis-inferring-a-cause-from-symptoms" class="section level2">
<h2><span class="header-section-number">7.3</span> Diagnosis: Inferring a cause from symptoms</h2>
<p>Sometimes we want to know whether a particular condition was present that could have caused an observed outcome. This is the stuff of medical diagnosis: on observing symptoms, is the sickness due to <span class="math inline">\(A\)</span> or to <span class="math inline">\(B\)</span>?</p>
<p>We imagine cases in which we do not get to observe the putative cause directly and we want to infer both whether the putative cause was present and whether it caused the outcome. This requires stating a query on both an effect and the level of an unobserved node.</p>
<p>An illustration:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;A -&gt; S -&gt; Y &lt;- B&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="st">  </span><span class="kw">set_restrictions</span>(<span class="kw">c</span>(<span class="st">&quot;(S[A=1]&lt; S[A=0])&quot;</span>, </a>
<a class="sourceLine" id="cb85-3" title="3">                   <span class="st">&quot;(Y[S=1]&lt;Y[S=0])&quot;</span>,</a>
<a class="sourceLine" id="cb85-4" title="4">                   <span class="st">&quot;(Y[S = 0, B = 0]== 1)&quot;</span>))</a>
<a class="sourceLine" id="cb85-5" title="5"></a>
<a class="sourceLine" id="cb85-6" title="6"><span class="kw">plot</span>(model)</a></code></pre></div>
<p><img src="causalmodels_files/figure-html/appdiagnosis-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">query_model</span>(model, </a>
<a class="sourceLine" id="cb86-2" title="2">       <span class="dt">queries =</span> <span class="kw">list</span>(<span class="dt">A=</span><span class="st">&quot;(Y[A=1] &gt; Y[A =0]) &amp; A==1&quot;</span>, <span class="dt">B=</span><span class="st">&quot;(Y[B=1] &gt; Y[B =0]) &amp; B==1&quot;</span>),</a>
<a class="sourceLine" id="cb86-3" title="3">       <span class="dt">given =</span> <span class="kw">list</span>(<span class="st">&quot;Y==1&quot;</span>,  <span class="st">&quot;Y==1 &amp; S==1&quot;</span>), <span class="dt">using =</span> <span class="st">&quot;priors&quot;</span>, </a>
<a class="sourceLine" id="cb86-4" title="4">       <span class="dt">expand_grid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>kable</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Given</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">Y==1</td>
<td align="left">priors</td>
<td align="right">0.200</td>
<td align="right">0.205</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">Y==1 &amp; S==1</td>
<td align="left">priors</td>
<td align="right">0.257</td>
<td align="right">0.233</td>
</tr>
<tr class="odd">
<td align="left">B</td>
<td align="left">Y==1</td>
<td align="left">priors</td>
<td align="right">0.443</td>
<td align="right">0.256</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">Y==1 &amp; S==1</td>
<td align="left">priors</td>
<td align="right">0.293</td>
<td align="right">0.219</td>
</tr>
</tbody>
</table>
<p>In this example there are two possible causes of interest, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. With flat priors the <span class="math inline">\(B\)</span> path starts as clearly more probable. Observation of symptom <span class="math inline">\(S\)</span>, which is a consequence of <span class="math inline">\(A\)</span>, however raises the chances that the outcome is due to <span class="math inline">\(A\)</span> and lowers the chances that it is due to <span class="math inline">\(B\)</span>.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-dawid2011role">
<p>Dawid, A Philip. 2011. “The Role of Scientific and Statistical Evidence in Assessing Causality.” <em>Perspectives on Causation</em>, 133–47.</p>
</div>
<div id="ref-hall2004two">
<p>Hall, Ned. 2004. “Two Concepts of Causation.” <em>Causation and Counterfactuals</em>, 225–76.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="applications.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="process-tracing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["causalmodels.pdf"],
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
